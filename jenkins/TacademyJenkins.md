## 참석이유

우리 회사는 현재 cafe24에서 php로 호스팅을 하여 서버를 구축하고 있었다.
하지만 호스팅의 부작용은 한두가지가 아니였다.
예를들면 인접 서버가 디도스 공격을 받음에 따라 같이 서버가 죽어버리는 현상도 있었고,
어느 권한 이상의 작업을 하지 못하는 경우가 허다했다.
또한 어플리케이션 사용자가 급격하게 늘어남에 따라 우리가 직접 제어할수 있는 서버가 필요했다.
그래서 AWS환경으로 옮기기로 마음을 먹었고, 그



## 젠킨스를 활용한 CI/CD

시작전
환경설정을 해놨어야 한다.
바로 시작을 했다. 협조사항이 있었는데,
강의중에는 간식을 자제 해줘야 한다.
질문사항 같은 경우는 카톡방에서 해주면 강사님이 확인을 하고나서 쉬는시간에 세션내용을 진행할것이다.
실습하고 나중에 ERROR나 문제가 생길경우에는 손을 들어서 진행을 한다.
온라인의 경우 네트워크 상태가 불안하기 때문에 환경을 바꿀수도 있었다.
URL이 변경될수도 있었는데, 온라인같은 경우는 달라질수 있었다.

이남훈 강사님이 진행을 해주었다.
젠킨스랑 CI/CD파이프라인을 한다.
강의자료에서 소개를 안되있었다.
블록체인 업체에서 백엔드 엔지니어로 ㅎ활동 과상화폐거래소 ETL파이프라인 구축경험이 있다.
젠킨스랑 CI/CD AWS내에서 클라우드 환경에서 젠킨스랑 같이 중점정을 했다.
클라우드가 대세인 만큼=

강의 목표
- CI/Cd파이프라인의 기본 개념에 대해서 이해한다
    - 하면 뭐가 좋은지
    
- 기본적인 운연환경
- 기본적인 개발환경에서 개발자 자체 로컬환경에서 개발을 한다. 로컬환경의 개발 프론트 백엔드 QA환경등
을 여러개의 개발환경을 구축을 하게된다. CICD파이프라인은 사용자배포 뿐만 아니라
내부 사용자들 QA 프론트 백엔드 지속적으로 하는것이 CICD 목저깅다.
파이프라인내에서 환경별로 배포가 진행되는지,
이 많은것들을 해주는게 젠키늣인데 기본 개념에 대해 이해한다.
- 젠킨스 내에 기본적인 파이프라인 기본적인 작업 통합하고 매끄럽게 나갈지 알수 있따.

목차
- CICD
- 기본 개념 동작방식
- 개발환경 기본동작이해
- PIPE라인
- 실습이 끝나고 수강생분들이 원하는 설문 시트 실제환경에서 TIP이나 어떻게 되는지 데이터 웨어하우스
ETL 파이프라인 클라우드 상에서 하는 시스템 자동화한 예를 들어서 실용사례를 볼수 있따.

- CI/CD란 무엇인가?
    - 지속적인 통합 =? 뭘 통합한다는거야
    - 대상은 코드이다.
    - 많은 의미이겠지만
    - 여러명의 많은 개발자가 로컬환경에서 개발을 하는데 합쳐서 소비자에게 내놓아야한다.
    - 사람이 일일이 만나서 차이가 있는걸 머지해서 배포하고 그런게 아니라
    - 카피해서 지속적으로 빠르게 배포하기 위함이다.
- CD? 무엇을 배달한다는거야?
    - 우리 서비스를 배달하는것이다.
    - 사용자 뿐만 아니라 내부 소비자( QA Front 관리자 사용자)들을
    코드를 사용할수 있는 배포를 다룬다.
    개발자는 코드가 작성했는데 내껄 누군가 쓰는게 목적이다.
    - Countinous Deplyment
        - 옛날에는 엔지니어가 붙어서 서버가 내려가지 않고 버전을 바꾸는것
        서버가 끊기지 않고 배포하는것 클라우드 서비스가 제공을 해준다.
        ECS를 사용한다 이번 강의에서는

- CICD란 개발자들이 개발하는 사용자들에게 지속적으로 배포되고 
- 단순하게 코드를 작성하는게 아니라 테스트를 하고 자바같은 컴파일하는 언어는 빌드를 하는것
- 이것들을 자동화 하는것
- 파이프라인
    - 개발자 -> 코드 -> 빌드 웹팩 타입스트립트 컴파인 자바컴파일-> 테스트 Jest junit -> 배포 ECS Rolling -> 사용자
    - 물흐르듯이 배포가 되기 위해서
    
- CI왜 필요한가
    - 10명의 개발자가 열심히 개발
    - 머지헬
    - 10명의 개발자가 열심히 개발
    - 1주후
    - 마지막 커밋 누구야
    - 여기저기서 개발한걸 합치니까 문제가 생긴다.
    - 10명꺼 개발 합치면 
    - 하루 날잡아서 배포하는데 문제가 많이 생긴다.
    - 맨날맨날 코드를 작성하자마자 합치는걸 위함
    - 모든 개발자들이 ㄴ탓하고 하는게 아니라 멘탈의 평화를 위해서 한다.
- CI를 하면
    - 코드를 작성만 하면 내 레포지토리를 ㅇ믿을수 있다.
    - 마음의 평안을 가지고 배포를 한다.
- CD는 왜필요한가
    - 백엔드 코드 개발
    - 프론트와 협업
    -   1주일동안 스크럼하고 배포하는데 100~1000줄 CTO가 배포하는데 너무 힘들다 ( 한명이 책임진다 보통 없으면)
    - 심지어 배포 스크립트작성 베어매탈 AWS콘솔들어가서 이거배포하고 프론트 배포 S3에 올리고 실수가 많아진다.
    - 결국 개발자가 코드만 짜면되지 뭐이리 할게 많아 ㅠㅜㅜ
    
 - CD와 함께라면
 
- 젠킨스 넌 누구냐
     귀찮은 작업을 해줌
     - 시종같이 생겼따.
     - 종이다. 귀찮은걸 다한다.
     - 사람이 퇴사하는데 주기적인작업할텐데 인간 젠킨스 하나 뽑아서 나가
     - 이 귀찮은 작업
     - 자바런테임에서 동작한다.
     - 없으면 도커배포판을 쓰자
     - 젠킨스를 우리 귀찮은일을 다해주는 시종 빌드 배포 테스트 까지 한다.
     - 개발만 할테니까 귀찮은걸 다해라
        - 기본개념
        - 자바 런타임에서 동작
        - 젠킨스에 도는 다양한 플러그인을 조합한다.
        - AWS 배포도 해야하고 도커빌드도하고 테스트도 하고,..
        - 하나의 플러그인으로 만든것이다.
        - IDE에서 VS코드같은거 모듈 쓰는것처럼
        - Secret KEy관리도 다해준다.
        - 젠킨스는 빈껍데기 플러그인을 조합해서 잘 조립해서 돌아가는게 목적
 - 그래서 Plugin
    - 정~~말 많은 플러그인들이 존재
    - 배우는게 귀찮아서 쉘안에서 많다.
    - 크리덴셜
        - 
    - 깃플러그인
        - 깃에 있는 소스를 긁어오는다
    -파이프라인 플러그인
    - 핵심적인 플러그인 들이 있다.
    
- 젠킨스 서버를 깔고
    - 우리가 요청페이지를 볼수 있따.
     8080포트를 볼수 있다.
     - 설치된 플러그인들을 볼수 있따.
     - Plugin 살펴보기
     - CredentialSPulgin
        - AWs 배포 깃가져오는것 아무권한없이는 불가능
         - SSH GItaccesstoken 등을 저장
         - 이게 안전한가? 의심스럽다.
         - 젠킨스 인스턴스 아이디 RSA고유아이디로 공개키 바잇ㄱ의 암호화를 시킨다.
         - 보안에 대해서는 어느정도 안전하다.
         - 퍼블릭 환경에서 하는게 아니라
         - PRivate환경에서 하기때문에 걱정을 그닥 안해야한다.
         - 개발자들도 못봐야한다.
         - Pipeline Plugoin
         - Docker plugin 
          -도커를 쓰기위해서
 - 파이프라잉ㄴ이란?
    - CICD 구현하기위한 일련의 플러그인
    - 파이프라인 흘러서 배포를 한다.
     -DSL로 작성을 한다.
     - 파이프라인을 궁극적으로 젠킨스로 한다.
      - 작업명세서 같은것
      - 볶음밥 레시피 같은것
      - 문법이 되는게. scripted pipeline Declarative(가독성이 좋다)
      
- 레시피 순서대로 쓸텐데
    - 문법들을 설명한다
    - Section
        - 요리 가장큰 개념
        - 어떤일 들을 할것이고
        - 누가 할것이고 대 카테고리
        - Agent Section
            - 젠킨스가 한 대가 돌수도 있고,
            - 대신해주는 얘 노예가 한명이면 힘들다
            - 시종을 몇명 부릴수 있다.
             -어떤 시종할 일을 시킬거냐 이걸
             - Agent Section
                - Master한테 시킬건지 노예1을 시킬건지
            - Jenkins node만 넣는게 아니라
            - 도커 컨테이너도 넣을수 있따.
            - 젠킨스 안에서 자바깔수 없다.
            - 도커 이미지를 통해서 자바로 빌드 할수 있다.
            - 노드JS컨테이너 다운받은뒤 해
            - post 레시피에서 기름넣고 김치넣고
            - 갃 순서마다 순서가 있따.
            - 스테이지가 끝난 이후 결과에 따라 후속조치 ㄹ취한다.
            - 콘솔하나 찍는다.
            - 슬랙에 배포되었습니다 등등
            - Statges Section
            - 큰 순서
            - 어떤일들을 처리
            - 빌드하는 스테이지
            - 프론트엔드 배포 스테이지
            - 일종의 카테고리
            - Declartaitces
            - 프론트엔드 빌드한다
            - 쉽게 안끝나지 않나
            - 웹팩 빌드 스테틱파일 집어넣고 
            여러가지 Declaratives 종류가 있다.
                 - Enviro 환경변수 파라미터 언제 실행되고 실행안되고
                 - 볶음밥을 예를 들면 후라이팬에 기름을 둘렀으면
                 다음에 안둘러도 되지 않다
                 - 이스테이지 했으면 다음에 안한다든가.
                 - 분기문을 넣을수 있다.
                 - triggers
                  어떤 주기로 실행된냐
                 - 깃 소스코드 몇분마다 한번씩 가져온다.
                 - 브랜치가 프로덕션이고
                 - 환경이 어떻게 되는지에 따라 해라
               
    -Stage
    -Declartive
    
- Steps
    - 스테이지 안에서는 할일이 많은데
    - 플러그인 내에서도 할게 많다
    - 디렉토리를 옮겨서 빌드 한다던가.
    - 다른 플러그인 까랑서 메소드 써서 일을 처리한다든가.
    - 여러가지 스텝들이 있다.
    - 플러그인은 도구의 집합
    - 스텝들을 쓸수 있는게 많다.
        - 깃 깔면
        - 도커
            - 도커가지고와서 빌드할수 있는 메소드를 사용할수 있다.
 
- 실습을 할때 자세히 보자
- 파이프라인이라는 제일큰 덩어리가 있다
에이전트 어떤 젠킨스
파이프라인에는 어떤 작업들이 있어
프리페어 하고 빌드 해라
- 어떤일들을 ㄹ것인가 디렉토리 가져와서 업로드 해


- 개발환경의 종류에는 무엇이 있을까?
    - 개발자가 개발하는 로컬환경 (IDE를 깔아서 개발한다.)
    - 개발자들끼리 개발 내용에 대한 통합 테스트하는 디벨롭먼트환경
    - QA엔지니어및 내부 사용자들이 QA환경
    - 실제 유저들이 사용하는 PROUCtion 환경
    
- 개발 프로세스
    - 자기가 코드를 작성한다.
    - 다른 개발자들이 차이가 나는지 비교를 한다. 젠킨스 만 하는게 아니라
     -깃 프리커밋 깃훅 을 통해서 커밋을 하기전에 로컬에서 테스트를 한다.
     - 테스트를 하지 않은 경우는 깃 커밋조차 통과하지 ㅁㅅ한다.
     - 진행한 내용을 깃에 데브브랜치에 올린다.
     - 깃을 보고있따가 코드 변화가 있을때 당겨와서 린트등을 빌드 포맷팅하고
     - 배포하고 빌드과정
     - 배포
     - 테스트
     - 이 모든 과정을 모두 환경에서 하고 한다.
 - 어떻게 환경마다 배포하냐
 
- 핵심은 막연하게 로컬 데브 다른것
    - 데이터베이스 패스워드
    - 백엔드 URl
    - 암호화 해시 키
    - 각각 배포를 할때 잘 설정해서 한다.
- 클라우드에서 하면 효과적으로 해주는 서비스가 있따.
- 데브환경에다가 써야할 URL은 뭐고 브로덕은 뭐고
- 클라우드 환경에서 하면 짱 편함
- aws에서 키관리하는 서비스들이 있다.
- 핵심은 뭐냐
- 프로덕션 데브 젠킨스들이 있따.
- 필요한 정보들을 어디서 가져오냐 저장하는곳이 AWS System Manager
- 젠킨스는 프로덕션빌드할때 프빌드할때 프로덕션껄로만 해
- QA가면 QA걸로 해
- 멀티 배포환경을 어렵게 생각하지말자, 각각 환경에서 차이가 나는게 무엇인지 알아보자
- 환경변수로 활용하는것이 중요하고

- 예씨 배포환경
    - 로컬에서 웹사이트 작성
    - 커밋하고 푸시하면 배포되는게 목적
    - 오늘할것
         -프론트엔드 서버띄우기 2개
         - 프론트엔드 쉬운것 S3에다가 올리는것 정적
         - 서비스를 붙이는것
         - 서버는 ECS 쿠버네티스
         - 젠킨스는 빌드까지만 하는것
         - 빌오케스트레ㅐ이션 하는것은 ECS나 쿠버네티스
         - 이지비를 배포하는것 업로드 하는것 로컬에서 로컬 실행히시키고
         - 젠킨서 서버를 같이 쓴다. 웹 사이트는 S3에 뜨고 서버는 젠킨스 인스턴스에 뜨고
         - 푸시할때마다 바뀌는것을 본다

- 실습을 할때
 -ECR S3 ECS 등
    - S3 네이버 클라우드
        - 코드를 입력해서 볼수 있다.
        - HTML파일을 올려두면 볼수 있다.
        - 장점은 CloudFront와 웹사이트 호스팅
        도메인 리소스 가져올것 정함
        - S3에 다 올렸기 때문에 그 용도로 많이 쓴다.
    - ECR
        - 도커를 만들어서 배포를 할건데
        - 도커이미지를 만들어서 배포해야하는데
        - 아마존내에서 개발할거니까 아마존 이미지 저장소에 넣고싶을때 쓴다.
        - 도커 이미지 저장소
        - 장점
        - 저장을 다해준다 몇일 지나면 지워진다 내가 배포했는데 이미지가 잘못된다
        - 바로 전걸 사용해서 업로드 해야한다
        - 테스트 배포 등등 못한다 시간이 없어서
        - ECR에서 끌어다가 배포한다.
    - ECS
        - 내 서비스를 스케일 업가능한 간단한 환경으로 배포를 해준다.
        - 페이스북은 서버 몇대써
        -서버를 많이 띄운다음에 분산을 해줘서 서비스를 해주는것
        - ECS 우리가 무언가를 서버 몇개띄우고 몇개에다가 어떤 도메인으로 왔을때 잘 분산도 해주고 ECS가 해준다.
        - ECS에 서비스를 올릴수 있고
        - 롤링 업데이트 로드밸런싱 부하처리 스케일업을 다해준다.
        - 서비스 업데이트해줘 한다.
        - 노드가 여러개 있다.
        - 서버만 떠잇는걸 눈으로 보고 싶어한다
        - 인스턴스를 딱 눈으로 보고싶으면
         EC2 확인할수 있게 한다.
        - 도커친화적으로 관리하고 싶어
        - 알아서 해줘 Fargate 아마존 인스턴스 볼수가 없다.
        - 내부적으로 서버들 까지도 관리를 해준다. 도커컨테이너 추상화를 많이 했다.
        - 젠킨스 ECS 업데이트 치면 끝이다.
        - 파이프라인만 구축할 것
        - 만능은 아닌게 메모리 관리가 안맞을수 있다.
        
- 실제 유저가 쓰는 환경은 안정적이여야한다
-   실제 기업에서는 한 계정으로 안쓴다.
- 환경을 완벽히 차단
- 프로덕션은 따른 계정
- 데브환경 프로덕션 환경 다 다른 사용한다.
- 네트워크 인터페이스도 다 다르다.
- 물리적으로 다 다르다.
- 그런환경에서 구축할때는 젠킨스를 여러개 띄운다.
- 싸게싸게 하고 싶으면
- 데브도 하고 프로더겻ㄴ도하고 할수 있다.
- 어느정도 규모가 있는 회사는 계정을 다 따로쓴다.
- SErvice cicd는 부족하다.
- 요새는 서비스 뿐만이 아니라 인프라도 CICD한다


## 실습한다.
