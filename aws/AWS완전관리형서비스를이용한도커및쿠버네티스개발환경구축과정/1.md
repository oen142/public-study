## AWS 네트워크 아키텍쳐 - EC2, VPC 구성실습

#### AWS - AWS퍼블릭 클라우드 특장점

#### AWS관리도구 - AWS콘솔, AWS CLI 

#### AWS-가상머신 - AWS가상머신 생성 및 구성 

#### AWS 네트워크 - AWS네트워크 아키텍쳐 

하이퍼바이저를 젠 서버로 한다
가상화 기술을 가능 하게끔 해주는게 하이퍼바이저 그중에서 젠 서버를 쓰고있다.
원격으로 보안이나 냉공장치나 그런거 필요없이 사용한 만큼 지불하면 된다.


- 왼쪽에서 오른쪽으로 갈수록 엄청 비싸진다.

- aws
    - iaas 관리를 해주겠다 물리적 장치를 인프라를 관리 해주겠다.
    서버를 사가지고 구축하지 말아라 os랑 개발 관련만 구축을 해라

- azure
    - 관리자가 관리할수 없도록 하는 서비스가  paas 서버를 해주겠다.
    개발만 하면된다. 

- saas
    - 1등은 sap
    - ERP 시스템 같은거
    - Gmail
    - google docs 등등
    
- 일정 수준의 인스턴스를 준다.개발을 할 필요가 없다.


- aws를 하는 이유
    - 1등이라서
    - 쿱은 gcp에서 하는게 맞지만
    - 최근 성장세 보면 가만히 있다.
    - azure가 따라간다.
- aws 특장점
    - 초기 비용 없이 사용한 만큼 지불하는 종량 과금제 방식
    - 온프레미스 서버 구축기간과 비교하여 빠른 인프라 구축 속도
    - 온프레미스 서버 환경의 리소스 확장 시와 달리 사전 리소스 확보 불필요
    - 인스턴스(가상 서버) 라이프사이클의 손쉬운 관리
    - 고 가용성 서비스를 무중단 및 무정지 장애허용 시스템 구축에 필요한 서비스 제공
        - L4스위치
        - Failover
        - 2중화 등등...
    - API 제공으로 서비스 관리 자동화 용이
         - 서비스가 멈추지 않는것이 중요하다.

- 요금이 결국 싸지는 않다.

- 과금 방식
    - 온 디멘드 인스턴스 : 짧은 워크로드 , 예측가능한 가격
        - 사용한 만큼 지불(첫 번째 1분후 초당 청구)
        -  비용은 가장 높지만 선불 결제는 없다
        - 장기 약정이 없다.
        - 애
    - 예약 : (최소 1년) 
        - 예약 인스턴스 : 긴 워크로드
        - 가변 예약 인스턴스 : 유연한 인스턴스가 있는 긴 워크로드
        - 스케쥴 예약 인스턴스 : 예 - 매주 목요일 오후 3시에서 6시 사이
            - 주문형에 비해(온디맨드) 최대 75%할인
            - 장기 약정으로 사용한 것에 대해 선 결제 한다.
            - 예약 기간은 1년 또는 3년이다.
            - 특정 인스턴스 유형을 예약한다.
            - 정상 상태 사용 응용 프로그램(db)에 권장된다.
            - 가변 예약 인스턴스
                - EC2 인스턴스 유형을 변경할 수 있다.
                - 최대 54% 할인
            - 스케쥴된 예약 인스턴스
            - 예약 한 시간냉 시작한다.
    - 스팟 인스턴스 : 짧은 워크로드, 저렴하지만 인스턴스를 잃을수 있다.
        - 주문형에 비해 최대 90% 할인을 받을수있다.
        - 최대가격이 현재 스팟 가격보다 낮은 경우 언제든지 손실할수 있는 인스턴스
        - AWS에서 가장 비용 효율적인 인스턴스
         - 장애에 탄력적인 워크로드에 유용하다.
            - 배치작업
            - 데이터 분석
            - 이미지 처리
        - 중요한 작업이나 데이터베이스에는 적합하지 않다.
        - 그레이트 콤보: 기준선 + 예약 주문형 및 피크에 대한 스팟 예약 인스턴스
    - 전용 인스턴스 : 다른 고객은 귀하의 하드웨어를 공유하지 않는다.
    - 전용 호스트 : 전체 물리적 서버를 예약하고 인스턴스 배치
    


#### 아마존 AWS- AWS구독,비용,서비스,아키텍쳐

EC2(Nova) - CPU 
    - RAM
EBS(Cinder) - SSD
VPC(Neutron) - NETWORK
AMI(Glance) - IMG

- 가용영역의 거리가 100km 이상 이면 안된다.

- 쿠버네티스의 스케줄러 가용역역이 있으면 헬스 체크를 한다.
- 일정한 시간내에 한가한 쪽에 분배를 한다.
- 서브넷을 설정하지 않으면 자동 설정이 됨

- 서울리전은 2a , b, c, d  b하고 d는 t2마이크로 서비스를 설치할수가 없다.
- 프리티어는 2a, 2c중에 하나를 선택하자

- 퍼블릭 IP 강점이 있따. 웹서버를 구축하는데에서 IP를 공인아이피, 라우트 같은걸 지불해야한다.
- 전세계 사람들에게 손쉽게 제공한다.

IPv4 퍼블릭 IP는 재부팅 할때에 매번 바뀔수 있다.
EIP를 사온다.
EIP는 EC2에 적용을 했을때 과금을 안하지만
적용을 안하면 과금을 한다. 


`systemctl start httpd`

`systemctl status httpd`

`systemctl enable httpd`

ping을찍으면 안나감
- 포트를 안열어서 안나감
-icmp

terminated 됐다가 일정 시간 뒤에 사라진다.

gcp 랑 azure는 프로젝트 개념이 있어서
프로젝트만 지워버리면 된다.
aws는 일일이 찾아서 지워야된다.
안그러면 요금 폭탄

- Amazone VPC
- 기본적으로 디폴트 네트워크가 있다.
- 네트워크의 주소 범위가 있따. 172.31.0.0/16이다. 리전단위로
- VPC안에 서브넷이 있다. 172.31.32.0/20 172.31.0.0/20 172.31.1.0/20
- 가용영역에 서브넷이 있다. 거리를 띄고 있다.
- 지금은 하나가 더 늘었다.
- 2a는 172.31.32.0/20
- 사용자의 AWS계정 전용 가상네트워크이다.

- 라우팅 테이블
    - VPC
    - 전체범위 172.31.0.0/16(서브넷 단위)
- 인터넷 게이트웨이
    - aws에서 바깥 IP세상으로 나가기 위해 필요
- Network ACL : 보안적인 부분 내부로 통신 , 외부로 통신을 기반으로 모든 통신을 본다.
- Security Group :

- 기본 VPC
    - 최 외곽은 리전
    - 그안에 VPC
    - 그안에 서브넷이 존재
    - 점선안에 가용성 존
    
- 내부네트워크
    - 같은 네트워크로 묶여있다.
    - 내부에서 서로의아이피가 아닌 다론곳으로 가는 
    
- 호스트이름
    - 긴 이름의 도메인네임값
    
- 서브넷
    - 가용영역
        - 
        
        
```js
#!/bin/bash
# Use this for your 
sudo su - root
yum update -y
yum install
```     
sudo file -s /dev/xvd*
lsblk

sudo growpart /dev/xvda 1
lsblk

df -Th
sudo xfs-growfs -d /

키 잊어버렸을 경우

볼륨을 살려야한다.
	/dev/xvda	
	
인스턴스 중지되어도 돈은 나간다
볼륨에서

스냅샷은 사진을 찍는것이다.
거기서 멈춘다. 그 장비가 망하면
데이터가 없어질 수 있다.

스냅샷은 로컬컴퓨터로 다운받을 수는 없다
서울리전에서 스냅샷을 찍으면 다른 리전으로 보낼수 있다.
크로스리전으로 보낼 수 있다.
보낼때 전송이 된다. 스냅샷 클수도 있음
그래서 리전 전송시 트래픽의 과금이 발생할 수 도 있음.

